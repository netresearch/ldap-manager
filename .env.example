# Docker BuildKit Configuration
# Required for Dockerfile cache mount optimizations (pnpm, Go modules, build cache)
# Enables ~60% faster builds on cache hits
DOCKER_BUILDKIT=1

# Only required for legacy 'docker-compose' (Python tool)
# Modern 'docker compose' (CLI plugin) doesn't need this
# COMPOSE_DOCKER_CLI_BUILD=1

# LDAP Configuration (used by compose.yml services)
# These environment variables are referenced in healthchecks and service configs
# Uncomment and set values if different from compose.yml defaults:
# LDAP_BASE_DN=dc=netresearch,dc=local
# LDAP_ADMIN_PASSWORD=admin

# Traefik Configuration (optional)
# Enable Traefik reverse proxy integration for production deployments
# When enabled, the application will use bridge networking instead of host mode
#
# Prerequisites:
# 1. Create external Traefik network: docker network create traefik
# 2. Ensure Traefik is running and connected to the same network
#
# TRAEFIK_ENABLE=false         # Set to 'true' to enable Traefik integration
# TRAEFIK_NETWORK=traefik      # External Traefik network name (default: traefik)
# TRAEFIK_HOST=localhost       # Domain suffix for routing (e.g., localhost, sobol.nr)
#
# Examples:
# - Local development with Traefik:
#   TRAEFIK_ENABLE=true
#   TRAEFIK_HOST=localhost
#   Access: https://ldap-manager.localhost
#
# - Production with global Traefik:
#   TRAEFIK_ENABLE=true
#   TRAEFIK_HOST=sobol.nr
#   Access: https://ldap-manager.sobol.nr
#
# - Without Traefik (default):
#   TRAEFIK_ENABLE=false
#   Access: http://localhost:3000

# Build Metadata (optional - used for OCI image labels)
# These must be set as environment variables before running docker compose
# .env files do NOT support command substitution!
#
# To set these values, run these commands in your shell BEFORE docker compose:
#   export BUILD_DATE=$(date -u +'%Y-%m-%dT%H:%M:%SZ')
#   export VCS_REF=$(git rev-parse --short HEAD 2>/dev/null || echo "dev")
#
# Or uncomment and manually set:
#BUILD_DATE=2024-01-01T00:00:00Z
#VCS_REF=abc1234
#
# If not set, OCI image labels will be empty (acceptable for dev builds)

# Usage:
# 1. Copy to .env: cp .env.example .env
# 2. Set BUILD_DATE/VCS_REF via export commands (see above)
# 3. Run: docker compose --profile dev build
# 4. Run: docker compose --profile dev up

# Notes:
# - BuildKit is REQUIRED for cache mounts to work
# - Without BuildKit, builds will be slower but still functional
# - BUILD_DATE and VCS_REF are optional for development
# - CI workflows set these automatically via GitHub Actions context
# - In production, ALWAYS set proper BUILD_DATE and VCS_REF values
